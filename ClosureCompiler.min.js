/*
 ClosureCompiler.js compiled by ClosureCompiler.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 Released under the Apache License, Version 2.0
 see: https://github.com/dcodeIO/ClosureCompiler.js for details
*/
(function(){function d(){}if("undefined"!=typeof window&&window.window||"function"!=typeof require)throw Error("ClosureCompiler.js can only be used within node.js");var h=require("path"),l=require("fs"),m=require("child_process");d.b=function(a,c,d){if(0>d.indexOf(c))throw"Illegal "+a+" value: "+c+" ("+d+" expected)";};d.JAVA_EXT="win32"==process.platform?".exe":"";d.getGlobalJava=function(){var a=null;process.env.JAVA_HOME&&(a=process.env.JAVA_HOME+h.sep+"bin"+h.sep+"java"+d.JAVA_EXT,l.existsSync(a)||
(a=null));a||(a="java");return a};d.getBundledJava=function(){return h.normalize(__dirname+h.sep+"jre"+h.sep+"bin"+h.sep+"java"+d.JAVA_EXT)};d.testJava=function(a,c){m.exec('"'+a+'" -version',{},function(a,d,h){0<=(""+h).indexOf('version "')?c(!0):c(!1)})};d.compile=function(a,c,h){(new d).compile(a,c,h)};d.prototype.compile=function(a,c,n){function m(a,b){require("child_process").exec(a,{c:20971520},b)}function p(a,b){m('"'+a+'" '+b,function(a,b,c){0<b.length||0<c.length?n(c+"",b+""):n(a,null)})}
c=c||{};for(var e={},g=Object.keys(c),b=0;b<g.length;b++)e[g[b].toLowerCase()]=c[g[b]];c=e;delete c.js;delete c.js_output_file;var k='-jar "'+__dirname+'/compiler/compiler.jar"';a instanceof Array||(a=[a]);for(b=0;b<a.length;b++){if("string"!=typeof a[b]||0<=a[b].indexOf('"'))throw Error("Illegal source file: "+a[b]);e=l.statSync(a[b]);if(!e.isFile())throw Error("Source file not found: "+a[b]);k+=' --js "'+a[b]+'"'}c.a||(c.a=[]);c.a instanceof Array||(c.a=[c.a]);g=[];for(b=0;b<c.a.length;b++)if(e=
l.statSync(c.a[b]),e.isDirectory()){e=l.readdirSync(c.a[b]);for(a=0;a<e.length;a++){var f=c.a[b]+"/"+e[a];l.statSync(f).isFile()&&".js"==h.extname(f).toLowerCase()&&g.push(f)}}else if(e.isFile())g.push(c.a[b]);else throw Error("Externs file not found: "+c.a[b]);delete c.externs;for(b=0;b<g.length;b++)k+=' --externs "'+g[b]+'"';g=Object.keys(c);for(b=0;b<g.length;b++){e=g[b];f=c[g[b]];if(!/[a-zA-Z0-9_]+/.test(e))throw Error("Illegal option: "+e);if(!0===f)k+=" --"+e;else if(!1!==f){f instanceof Array||
(f=[f]);for(a=0;a<f.length;a++){if(!/[^\s]*/.test(f))throw Error("Illegal value for option "+e+": "+f);k+=" --"+e+" "+f}}}d.testJava(d.getGlobalJava(),function(a){a?p(d.getGlobalJava(),k):d.testJava(d.getBundledJava(),function(a){if(a)p(d.getBundledJava(),k);else throw Error("Java is not available, neither the bundled nor a global one.");})})};d.prototype.toString=function(){return"ClosureCompiler"};module.exports=d})(this);
